<div class="row">
  <div class="col-lg-12">
    <h1 class="page-header"><i class="fa fa-list-ol fa-fw"></i> {{interview.name}}</h1>
  </div>
</div>

<div class="row">
  <div class="col-sm-12">

    <a class="btn btn-default" [routerLink]="['/interviews']">
      <i class="fa fa-arrow-left" aria-hidden="true"></i> Inteviews List
    </a>
    <div class="spacer-md"></div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Details</h3>
      </div>
      <div class="panel-body">

        <p>Interview Name: {{interview.name}}</p>
        <p>Status: {{interview.status | filterInterviewStatus}}</p>
        <p *ngIf="interview.candidate">Candidate: {{interview.candidate.firstName}} {{interview.candidate.lastName}}</p>
        <p *ngIf="interview.role">Role: {{interview.role.name}}</p>
        <span>
          Interviewers:
          <ul>
            <li *ngFor="let interviewer of interview.interviewers">{{interviewer.firstName}} {{interviewer.lastName}}</li>
          </ul>
        </span>
        <p>
          {{contactLabel}}:
          <span *ngIf="interview.contactType !== contactTypeCatalog.ZOOM">{{interview.contact}}</span>
          <a *ngIf="interview.contactType === contactTypeCatalog.ZOOM" href="{{interview.contact}}">{{interview.contact}}</a>
        </p>

      </div>

      <div class="panel-footer">
        <div class="row">
          <div class="col-sm-12">
            <a class="btn btn-default" [routerLink]="['/interviews']">
              <i class="fa fa-ban" aria-hidden="true"></i> Cancel
            </a>
            <button type="button" class="btn btn-primary pull-right"
                    *ngIf="allowEdition && interview.status == CONSTANTS.INTERVIEW_STATUS.OPEN"
                    (click)="start()">
              <i class="fa fa-play-circle"></i> Start Interview
            </button>
            <button type="button" class="btn btn-primary pull-right"
                    *ngIf="allowEdition && interview.status == CONSTANTS.INTERVIEW_STATUS.IN_PROGRESS"
                    (click)="complete()"
                    [disabled]="!interview.answers || interview.answers.length == 0 || !interview.feedbacks || interview.feedbacks.length == 0">
              <i class="fa fa-check" aria-hidden="true"></i> Complete Interview
            </button>
          </div>
        </div>
      </div>

    </div>

    <div *ngIf="allowEdition && interview.status != CONSTANTS.INTERVIEW_STATUS.OPEN">

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Questions</h3>
        </div>
        <div class="panel-body">

          <div class="form-group" *ngIf="interview.status == CONSTANTS.INTERVIEW_STATUS.IN_PROGRESS">
            <label>Add New Question</label>
            <div class="row">
              <div class="col-sm-6">
                <input class="form-control" required [(ngModel)]="newAnswer.question.question" id="question" name="question"
                       #question="ngModel" />
              </div>
              <div class="col-sm-6">
                <button type="button" class="btn btn-primary" [disabled]="!newAnswer.question.question" (click)="addQuestion()">Add</button>
              </div>
            </div>
          </div>

          <div class="panel panel-default">
            <div class="panel-heading clickable" (click)="toggleHelp()">
              <h3 class="panel-title"><i class="fa fa-question-circle" aria-hidden="true"></i> Rates</h3>
            </div>
            <div class="panel-body" [hidden]="!showHelp">
              <div class="row">
                <div class="col-sm-4">
                  <p><ngb-rating max="5" rate="0" class="raiting" readonly="true"></ngb-rating> Not Used</p>
                </div>
                <div class="col-sm-4">
                  <p><ngb-rating max="5" rate="1" class="raiting" readonly="true"></ngb-rating> Poor</p>
                </div>
                <div class="col-sm-4">
                  <p><ngb-rating max="5" rate="2" class="raiting" readonly="true"></ngb-rating> Fair</p>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-4">
                  <p><ngb-rating max="5" rate="3" class="raiting" readonly="true"></ngb-rating> Average</p>
                </div>
                <div class="col-sm-4">
                  <p><ngb-rating max="5" rate="4" class="raiting" readonly="true"></ngb-rating> Good</p>
                </div>
                <div class="col-sm-4">
                  <p><ngb-rating max="5" rate="5" class="raiting" readonly="true"></ngb-rating> Excelent!</p>
                </div>
              </div>
            </div>
          </div>

          <ol>
            <li *ngFor="let answer of interview.answers; let i = index">
              <p class="question">
                <b>{{answer.question.question}}</b> <i class="fa fa-times icon-btn-md" (click)="removeQuestion(i)"></i>
              </p>
              <textarea class="form-control" [(ngModel)]="answer.answer" placeholder="Enter Answer"
                        [readonly]="interview.status != CONSTANTS.INTERVIEW_STATUS.IN_PROGRESS"></textarea>

              <ngb-rating max="5" [(ngModel)]="answer.rate" class="raiting"></ngb-rating>
              <label [hidden]="!answer.rate || answer.rate !== 0">Not Used</label>
              <label [hidden]="!answer.rate || answer.rate !== 1">Poor</label>
              <label [hidden]="!answer.rate || answer.rate !== 2">Fair</label>
              <label [hidden]="!answer.rate || answer.rate !== 3">Average</label>
              <label [hidden]="!answer.rate || answer.rate !== 4">Good</label>
              <label [hidden]="!answer.rate || answer.rate !== 5">Excelent!</label>

            </li>
          </ol>

        </div>
        <div class="panel-footer">
          <div class="row">
            <div class="col-sm-12">
              <button type="button" class="btn btn-primary pull-right"
                      *ngIf="interview.status == CONSTANTS.INTERVIEW_STATUS.IN_PROGRESS" (click)="save()">
                Save
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="panel panel-default" *ngIf="interview.id && interview.interviewers && interview.interviewers.length > 0">
        <div class="panel-heading">
          <h3 class="panel-title">Feedback</h3>
        </div>
        <div class="panel-body">

          <div class="panel panel-info">

            <div class="panel-heading">
              <h3 class="panel-title">My Feedback</h3>
            </div>
            <div class="panel-body">

              <div class="form-group">
                <textarea class="form-control" [(ngModel)]="myFeedback.comment" placeholder="Provide Feedback"
                          [readonly]="interview.status != CONSTANTS.INTERVIEW_STATUS.IN_PROGRESS"></textarea>
              </div>

              <button type="button" class="btn btn-primary pull-right"
                      *ngIf="interview.status == CONSTANTS.INTERVIEW_STATUS.IN_PROGRESS" (click)="addFeedback()">
                Save
              </button>

            </div>

          </div>

          <div class="panel panel-info" *ngFor="let feedback of elseFeedbacks; let i = index">

            <div class="panel-heading">
              <h3 class="panel-title" *ngIf="feedback.interviewer">{{feedback.interviewer.firstName}} {{feedback.interviewer.lastName}}'s Feedback</h3>
            </div>
            <div class="panel-body" [innerHTML]="feedback.comment"></div>

          </div>

        </div>
      </div>

    </div>

  </div>
</div>